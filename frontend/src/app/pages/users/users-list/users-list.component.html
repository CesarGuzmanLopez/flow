<div class="page-container">
    <div class="page-header">
        <h1>Users Management</h1>
        <div class="header-actions">
            <button class="btn-secondary" (click)="loadUsers()">
                Reload
            </button>
            <button class="btn-primary" (click)="openCreateModal()">
                + Create User
            </button>
        </div>
    </div>

    @if (error()) {
    <div class="error-banner">
        <span>⚠️ {{ error() }}</span>
        <button (click)="error.set(null)">✕</button>
    </div>
    }

    <div class="content">
        <app-data-table [columns]="columns" [data]="users()" [loading]="loading()" emptyMessage="No users found"
            (rowClick)="onRowClick($event)" />
    </div>

    <app-modal [visible]="showCreateModal()" (close)="closeCreateModal()" size="medium">
        <div header>
            <h2>Create New User</h2>
        </div>
        <div content>
            <form class="user-form" (submit)="$event.preventDefault(); createUser()">
                <div class="form-group">
                    <label for="username">Username *</label>
                    <input id="username" type="text" [(ngModel)]="newUser().username" name="username" required />
                </div>
                <div class="form-group">
                    <label for="email">Email *</label>
                    <input id="email" type="email" [(ngModel)]="newUser().email" name="email" required />
                </div>
                <div class="form-group">
                    <label for="password">Password *</label>
                    <input id="password" type="password" [(ngModel)]="newUser().password" name="password" required />
                </div>
                <div class="form-group">
                    <label for="first_name">First Name</label>
                    <input id="first_name" type="text" [(ngModel)]="newUser().first_name" name="first_name" />
                </div>
                <div class="form-group">
                    <label for="last_name">Last Name</label>
                    <input id="last_name" type="text" [(ngModel)]="newUser().last_name" name="last_name" />
                </div>
            </form>
        </div>
        <div footer>
            <button class="btn-secondary" type="button" (click)="closeCreateModal()">
                Cancel
            </button>
            <button class="btn-primary" type="button" (click)="createUser()">
                Create
            </button>
        </div>
    </app-modal>
</div>
